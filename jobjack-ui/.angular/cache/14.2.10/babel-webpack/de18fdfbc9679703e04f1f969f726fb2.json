{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { Component, ViewChild, ElementRef } from '@angular/core';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { FormControl } from '@angular/forms';\nimport { filter, debounceTime, tap, distinctUntilChanged } from \"rxjs/operators\";\nimport { PaginatedSearchResultDto } from 'src/app/dto/paginated-search-result-dto';\nimport { SearchService } from 'src/app/search/services/search.service';\nimport { DirEntryDatasource } from 'src/app/search/components/dir-entry-datasource/dir-entry-datasource';\nlet SearchComponent = class SearchComponent {\n  constructor(searchService) {\n    this.searchService = searchService;\n    this.search = new PaginatedSearchResultDto();\n    this.term = new FormControl();\n    this.displayedColumns = ['path', 'size', 'name', 'permissions'];\n  }\n\n  ngOnInit() {\n    this.term.valueChanges.pipe(debounceTime(400)).pipe(distinctUntilChanged(), filter(term => term !== ''), tap(term => this.loadDirEntryPage()));\n    this.dataSource = new DirEntryDatasource(this.searchService);\n  }\n\n  ngAfterViewInit() {\n    this.term.valueChanges.pipe(debounceTime(150), distinctUntilChanged(), tap(() => {\n      this.paginator.pageIndex = 0;\n      this.loadDirEntryPage();\n    })).subscribe();\n    this.paginator.page.pipe(tap(() => this.loadDirEntryPage())).subscribe();\n    this.term.setValue('/');\n  }\n\n  loadDirEntryPage() {\n    this.dataSource.searchDir(this.term.value, this.paginator.pageIndex + 1, this.paginator.pageSize);\n  }\n\n  openDir(dir) {\n    if (dir.isDir) {\n      this.term.setValue(dir.path);\n    }\n  }\n\n};\n\n__decorate([ViewChild(MatPaginator, {\n  static: true\n}), __metadata(\"design:type\", MatPaginator)], SearchComponent.prototype, \"paginator\", void 0);\n\n__decorate([ViewChild('input'), __metadata(\"design:type\", ElementRef)], SearchComponent.prototype, \"input\", void 0);\n\nSearchComponent = __decorate([Component({\n  selector: 'app-search',\n  templateUrl: './search-results.component.html',\n  styleUrls: ['./search-results.component.scss']\n}), __metadata(\"design:paramtypes\", [SearchService])], SearchComponent);\nexport { SearchComponent };","map":null,"metadata":{},"sourceType":"module"}