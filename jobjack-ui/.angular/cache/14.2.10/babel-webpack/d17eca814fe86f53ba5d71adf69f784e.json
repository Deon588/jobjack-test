{"ast":null,"code":"import { BehaviorSubject, of } from 'rxjs';\nimport { catchError, finalize } from 'rxjs/operators';\nimport { PaginatedSearchResultDto } from 'src/app/dto/paginated-search-result-dto';\nexport class DirEntryDatasource {\n  constructor(searchService) {\n    this.searchService = searchService;\n    this.DirEntrysSubject = new BehaviorSubject([]);\n    this.loadingSubject = new BehaviorSubject(false);\n    this.loading$ = this.loadingSubject.asObservable();\n  }\n\n  connect(collectionViewer) {\n    return this.DirEntrysSubject.asObservable();\n  }\n\n  disconnect(collectionViewer) {\n    this.DirEntrysSubject.complete();\n    this.loadingSubject.complete();\n  }\n\n  searchDir(term = '/', page = 1, pageSize = 20) {\n    let search = new PaginatedSearchResultDto();\n    search.term = term;\n    search.page = page;\n    search.size = pageSize;\n    this.loadingSubject.next(true);\n    this.searchService.searchDir(search).pipe(catchError(() => of([])), finalize(() => this.loadingSubject.next(false))).subscribe(res => {\n      // this.search = res;\n      search.results = res.results;\n      this.DirEntrysSubject.next(search.results);\n      this.loadingSubject.next(false);\n      console.log(res); // this.newResults(res);\n    });\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}