{"ast":null,"code":"import { __decorate, __metadata } from \"tslib\";\nimport { Component, ViewChild, ChangeDetectorRef } from '@angular/core';\nimport { MatPaginator } from '@angular/material/paginator';\nimport { MatTableDataSource } from '@angular/material/table';\nimport { FormControl } from '@angular/forms';\nimport { filter, debounceTime, switchMap, distinctUntilChanged } from \"rxjs/operators\";\nimport { PaginatedSearchResultDto } from 'src/app/dto/paginated-search-result-dto';\nimport { SearchService } from 'src/app/search/services/search.service';\nlet SearchResultsComponent = class SearchResultsComponent {\n  constructor(searchService, cdRef) {\n    this.searchService = searchService;\n    this.cdRef = cdRef;\n    this.search = new PaginatedSearchResultDto();\n    this.term = new FormControl();\n    this.displayedColumns = ['path', 'size', 'name', 'permissions'];\n  }\n\n  ngOnInit() {\n    this.term.valueChanges.pipe(debounceTime(400)).pipe(distinctUntilChanged(), filter(term => term !== ''), switchMap(term => {\n      this.search.term = term;\n      return this.searchDir();\n    }));\n    this.dataSource = new MatTableDataSource();\n  }\n\n  setDataSourceAttributes() {\n    this.dataSource.paginator = this.paginator;\n  }\n\n  newResults(e) {\n    // this.resultLength = e.resultLength;\n    this.dataSource.data = e.results;\n    this.cdRef.detectChanges();\n    console.log(\"Datasource\", this.dataSource); // this.dataSource.paginator = this.paginator;\n  }\n\n  onPaginate(e) {\n    console.log(e);\n  }\n\n  openDir(dir) {\n    if (dir.isDir) {\n      this.search.term = dir.path;\n      this.searchDir();\n    }\n  }\n\n  searchDir() {\n    this.searchService.searchDir(this.search).subscribe(res => {\n      this.search = res;\n      console.log(res);\n      this.newResults(res);\n    }, err => {\n      console.error(err);\n    });\n  }\n\n};\n\n__decorate([ViewChild(MatPaginator, {\n  static: true\n}), __metadata(\"design:type\", MatPaginator)], SearchResultsComponent.prototype, \"paginator\", void 0);\n\nSearchResultsComponent = __decorate([Component({\n  selector: 'app-dir-search-results',\n  templateUrl: './search-results.component.html'\n}), __metadata(\"design:paramtypes\", [SearchService, ChangeDetectorRef])], SearchResultsComponent);\nexport { SearchResultsComponent };","map":null,"metadata":{},"sourceType":"module"}